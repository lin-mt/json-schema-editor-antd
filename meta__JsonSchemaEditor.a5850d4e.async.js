(self.webpackChunk_quiet_front_end_json_schema_editor_antd=self.webpackChunk_quiet_front_end_json_schema_editor_antd||[]).push([[593],{77102:function(Le,te,n){"use strict";n.r(te),n.d(te,{demos:function(){return s}});var Ze=n(15009),U=n.n(Ze),Pe=n(99289),y=n.n(Pe),ie=n(67294),Re=n(57396),w=n(9170),s={"jsonschemaeditor-demo-0":{component:ie.memo(ie.lazy(y()(U()().mark(function ve(){var M,me;return U()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,Promise.resolve().then(n.bind(n,9170));case 2:return M=G.sent,me=M.JsonSchemaEditor,G.abrupt("return",{default:function(){return ie.createElement(me,null)}});case 5:case"end":return G.stop()}},ve)})))),asset:{type:"BLOCK",id:"jsonschemaeditor-demo-0",refAtomIds:["JsonSchemaEditor"],dependencies:{"index.jsx":{type:"FILE",value:`import { JsonSchemaEditor } from '@quiet-front-end/json-schema-editor-antd';

export default () => <JsonSchemaEditor />;`},"@quiet-front-end/json-schema-editor-antd":{type:"NPM",value:"1.0.7"}},entry:"index.jsx"},context:{"@quiet-front-end/json-schema-editor-antd":w},renderOpts:{compile:function(){var ve=y()(U()().mark(function me(){var pe,G=arguments;return U()().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return ne.next=2,n.e(335).then(n.bind(n,37335));case 2:return ne.abrupt("return",(pe=ne.sent).default.apply(pe,G));case 3:case"end":return ne.stop()}},me)}));function M(){return ve.apply(this,arguments)}return M}()}}}},9170:function(Le,te,n){"use strict";n.r(te),n.d(te,{JsonSchemaEditor:function(){return jt}});var Ze=n(52677),U=n.n(Ze),Pe=n(5574),y=n.n(Pe),ie=n(68872),Re=n(96486),w=n.n(Re),s=n(67294),ve=n(97857),M=n.n(ve),me=n(39398),pe=n(14313),G=n(42952),Ce=n(24969),ne=n(57546),Ne=n(48689),Ue=n(13769),Ve=n.n(Ue),De=n(9361),B=n(23323),$e=n(75027),k=n(71230),u=n(15746),he=n(56846),Q=n(24435),Me=n(21628),we=n(41637),le=n(92797),Ge=n(63764),Qe={base:"vs",inherit:!0,rules:[{background:"FFFFFF",token:""},{foreground:"008e00",token:"comment"},{foreground:"7d4726",token:"meta.preprocessor"},{foreground:"7d4726",token:"keyword.control.import"},{foreground:"df0002",token:"string"},{foreground:"3a00dc",token:"constant.numeric"},{foreground:"c800a4",token:"constant.language"},{foreground:"275a5e",token:"constant.character"},{foreground:"275a5e",token:"constant.other"},{foreground:"c800a4",token:"variable.language"},{foreground:"c800a4",token:"variable.other"},{foreground:"c800a4",token:"keyword"},{foreground:"c900a4",token:"storage"},{foreground:"438288",token:"entity.name.class"},{foreground:"790ead",token:"entity.name.tag"},{foreground:"450084",token:"entity.other.attribute-name"},{foreground:"450084",token:"support.function"},{foreground:"450084",token:"support.constant"},{foreground:"790ead",token:"support.type"},{foreground:"790ead",token:"support.class"},{foreground:"790ead",token:"support.other.variable"}],colors:{"editor.foreground":"#000000","editor.background":"#FFFFFF","editor.selectionBackground":"#B5D5FF","editor.lineHighlightBackground":"#00000012","editorCursor.foreground":"#000000","editorWhitespace.foreground":"#BFBFBF"}},e=n(85893),Xe=function(r){var p=r.width,C=r.lineNumbers,I=C===void 0?"on":C,i=r.height,P=r.value,m=r.folding,O=m===void 0?!0:m,c=r.language,E=r.readOnly,T=E===void 0?!1:E,J=r.renderLineHighlight,S=J===void 0?"all":J,L=r.onChange,X=De.Z.useToken(),W=X.token;function K(z){z.editor.defineTheme("x-code-default",Qe)}return(0,e.jsx)("div",{style:{border:"1px solid ".concat(W.colorBorder),width:p||"100%"},children:(0,e.jsx)(Ge.ZP,{height:i,width:p,value:P,language:c,onChange:L,onMount:r.handleEditorDidMount,beforeMount:K,theme:"x-code-default",options:{readOnly:T,lineNumbers:I,renderLineHighlight:S,folding:O,smoothScrolling:!0,fontSize:13,scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:9,horizontalScrollbarSize:9},minimap:{enabled:!1}}})})},We=Xe,Ye=n(15009),Oe=n.n(Ye),qe=n(99289),Ke=n.n(qe),_e=n(64599),et=n.n(_e),tt=n(65009),nt=n.n(tt);function ue(t,r){if(t.$ref){var p=t.$ref;if(p.startsWith("#/")){var C=p.slice(2).split("/"),I=w().cloneDeep(r),i=et()(C),P;try{for(i.s();!(P=i.n()).done;){var m=P.value;if(I[m])I=I[m];else throw new Error("Unable to resolve $ref: ".concat(p))}}catch(c){i.e(c)}finally{i.f()}return I}else throw new Error("Unsupported $ref format: ".concat(p))}if(t.properties)for(var O in t.properties)t.properties[O]&&(t.properties[O]=ue(t.properties[O],r));return t.items&&(Array.isArray(t.items)?t.items=t.items.map(function(c){return ue(c,r)}):t.items=ue(t.items,r)),t.oneOf&&(t.oneOf=t.oneOf.map(function(c){return ue(c,r)})),t.anyOf&&(t.anyOf=t.anyOf.map(function(c){return ue(c,r)})),t.allOf&&(t.allOf=t.allOf.map(function(c){return ue(c,r)})),t}function de(t){var r;if(t.$ref){var p=t.$ref;if(p.startsWith("#/")){var C=p.slice(2).split("/");return C[0]}if(t.properties){for(var I in t.properties)if(t.properties[I]&&(r=de(t.properties[I]),r))return r}}if(t.items){if(Array.isArray(t.items))for(var i=0;i<t.items.length;i++){var P=t.items[i];if(r=de(P),r)return r}else if(r=de(t.items),r)return r}if(t.oneOf)for(var m=0;m<t.oneOf.length;m++){var O=t.oneOf[m];if(r=de(O),r)return r}if(t.anyOf)for(var c=0;c<t.anyOf.length;c++){var E=t.anyOf[c];if(r=de(E),r)return r}if(t.allOf)for(var T=0;T<t.allOf.length;T++){var J=t.allOf[T];if(r=de(J),r)return r}}function rt(t){return Be.apply(this,arguments)}function Be(){return Be=Ke()(Oe()().mark(function t(r){var p,C;return Oe()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,nt().dereference(r,{mutateInputSchema:!1,dereference:{circular:"ignore"}});case 2:if(p=i.sent,C=de(p),!C){i.next=6;break}return i.abrupt("return",ue(p,p));case 6:return i.abrupt("return",p);case 7:case"end":return i.stop()}},t)})),Be.apply(this,arguments)}function at(t){if(typeof t=="string"){var r=t.trim();if(r.startsWith("{")&&r.endsWith("}"))try{return JSON.parse(r)}catch(p){return}}}var ze=["string","number","array","object","boolean","integer"];function ge(t,r){if(t===null||U()(t)!=="object")return console.error("The provided value is not an object."),-1;var p=Object.keys(t);return p.indexOf(r)}var ot=[{value:"date-time"},{value:"date"},{value:"time"},{value:"email"},{value:"hostname"},{value:"ipv4"},{value:"ipv6"},{value:"uri"},{value:"regex"}],st=ze.map(function(t){return{value:t}});function He(t){switch(t){case"string":return{type:"string"};case"number":return{type:"number"};case"boolean":return{type:"boolean"};case"object":return{type:"object",properties:{}};case"integer":return{type:"integer"};case"array":return{type:"array",items:{type:"string"}};case"null":}return{type:"string"}}var it=function(r){var p=function(i){return Array.isArray(i)?"array":i===null?"null":U()(i)},C=function I(i){var P=p(i);switch(P){case"object":{var m={};for(var O in i)i.hasOwnProperty(O)&&(m[O]=I(i[O]));return{type:"object",properties:m,required:Object.keys(i)}}case"array":return{type:"array",items:i.length?I(i[0]):{}};default:return{type:P}}};return C(r)},lt=["key","name"],ut=function(t){var r=t.schema,p=t.open,C=p===void 0?!1:p,I=t.onOk,i=t.onCancel,P=De.Z.useToken(),m=P.token,O=B.Z.useForm(),c=y()(O,1),E=c[0],T=(0,s.useState)(),J=y()(T,2),S=J[0],L=J[1],X=(0,s.useState)(!1),W=y()(X,2),K=W[0],z=W[1],v=(0,s.useState)(!1),re=y()(v,2),l=re[0],g=re[1],a=(0,s.useState)(!1),o=y()(a,2),h=o[0],f=o[1],Z=(0,s.useState)(!1),F=y()(Z,2),A=F[0],N=F[1],ce=(0,s.useState)(!1),x=y()(ce,2),Y=x[0],q=x[1],H=(0,s.useState)(!1),_=y()(H,2),V=_[0],fe=_[1],R=(0,s.useState)(!1),Fe=y()(R,2),ae=Fe[0],Ae=Fe[1],ee=(0,s.useRef)(null);(0,s.useEffect)(function(){L(r)},[r]),(0,s.useEffect)(function(){z(C)},[C]);var ye=(0,s.useCallback)(w().debounce(function(b){typeof b=="function"?b():console.log("Provided argument is not a function")},300,{maxWait:1e3}),[]);(0,s.useEffect)(function(){return function(){ye.cancel()}},[ye]),(0,s.useEffect)(function(){!K||!S||(E.setFieldsValue(S),g(S.type==="object"),f(S.type==="array"),N(S.type==="number"),q(S.type==="boolean"),fe(S.type==="integer"),Ae(S.type==="string"))},[K,S]);function Je(b){ee.current=b,ee.current.setValue(JSON.stringify(r,null,2))}function xe(){i&&i(),z(!1)}return(0,e.jsx)($e.Z,{title:"\u9AD8\u7EA7\u8BBE\u7F6E2",width:900,open:K,onOk:function(){E.validateFields().then(function(d){return I&&I(M()(M()({},S),d))}).catch(function(d){console.log("Failed:",d)}).finally(function(){return xe()})},onCancel:xe,children:(0,e.jsxs)(B.Z,{form:E,onValuesChange:function(d,oe){ee.current&&ee.current.setValue(JSON.stringify(M()(M()({},S),oe),null,2))},children:[!l&&ze.indexOf(S==null?void 0:S.type)!==-1&&(0,e.jsx)("div",{style:{borderLeft:"3px solid ".concat(m.colorPrimary),fontSize:16,fontWeight:399,paddingLeft:8,marginBottom:13},children:"\u57FA\u672C\u8BBE\u7F6E"}),(ae||A||V||Y)&&(0,e.jsxs)(k.Z,{justify:"start",align:"middle",style:{marginBottom:13},children:[(0,e.jsx)(u.Z,{span:4,style:{textAlign:"right"},children:"\u9ED8\u8BA4\u503C\uFF1A"}),(0,e.jsx)(u.Z,{span:8,children:(0,e.jsxs)(B.Z.Item,{noStyle:!0,name:"default",children:[ae&&(0,e.jsx)(he.Z,{style:{width:"100%"},placeholder:"\u8BF7\u8F93\u5165\u9ED8\u8BA4\u503C"}),(A||V)&&(0,e.jsx)(Q.Z,{style:{width:"100%"},placeholder:"\u8BF7\u8F93\u5165\u9ED8\u8BA4\u503C"}),Y&&(0,e.jsx)(Me.Z,{style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u9ED8\u8BA4\u503C",options:[{value:!0,label:"true"},{value:!1,label:"false"}]})]})})]}),ae&&(0,e.jsxs)(k.Z,{justify:"start",align:"middle",style:{marginBottom:13},children:[(0,e.jsx)(u.Z,{span:4,style:{textAlign:"right"},children:"\u6700\u5C0F\u957F\u5EA6\uFF1A"}),(0,e.jsx)(u.Z,{span:8,children:(0,e.jsx)(B.Z.Item,{noStyle:!0,name:"minLength",children:(0,e.jsx)(Q.Z,{min:0,style:{width:"100%"},parser:function(d){return d?parseInt(d.replace(/\D/g,""),10):""},formatter:function(d){return d?"".concat(Math.floor(Math.max(d,0))):""},placeholder:"\u8BF7\u8F93\u5165\u6700\u5C0F\u957F\u5EA6"})})}),(0,e.jsx)(u.Z,{span:4,style:{textAlign:"right"},children:"\u6700\u5927\u957F\u5EA6\uFF1A"}),(0,e.jsx)(u.Z,{span:8,children:(0,e.jsx)(B.Z.Item,{noStyle:!0,name:"maxLength",children:(0,e.jsx)(Q.Z,{min:0,style:{width:"100%"},parser:function(d){return d?parseInt(d.replace(/\D/g,""),10):""},formatter:function(d){return d?"".concat(Math.floor(Math.max(d,0))):""},placeholder:"\u8BF7\u8F93\u5165\u6700\u5927\u957F\u5EA6"})})})]}),(A||V)&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(k.Z,{justify:"start",align:"middle",style:{marginBottom:13},children:[(0,e.jsx)(u.Z,{span:4,style:{textAlign:"right"},children:"\u6700\u5C0F\u503C\uFF1A"}),(0,e.jsx)(u.Z,{span:8,children:(0,e.jsx)(B.Z.Item,{noStyle:!0,name:"minimum",children:(0,e.jsx)(Q.Z,{style:{width:"100%"},placeholder:"\u8BF7\u8F93\u5165\u6700\u5C0F\u503C"})})}),(0,e.jsx)(u.Z,{span:4,style:{textAlign:"right"},children:"\u6700\u5927\u503C\uFF1A"}),(0,e.jsx)(u.Z,{span:8,children:(0,e.jsx)(B.Z.Item,{noStyle:!0,name:"maximum",children:(0,e.jsx)(Q.Z,{style:{width:"100%"},placeholder:"\u8BF7\u8F93\u5165\u6700\u5927\u503C"})})})]}),(0,e.jsxs)(k.Z,{justify:"start",align:"middle",style:{marginBottom:13},children:[(0,e.jsx)(u.Z,{span:4,style:{textAlign:"right"},children:"\u6392\u4ED6\u6700\u5C0F\u503C\uFF1A"}),(0,e.jsx)(u.Z,{span:8,children:(0,e.jsx)(B.Z.Item,{noStyle:!0,name:"exclusiveMinimum",children:(0,e.jsx)(Q.Z,{style:{width:"100%"},placeholder:"\u8BF7\u8F93\u5165\u6392\u4ED6\u6700\u5C0F\u503C"})})}),(0,e.jsx)(u.Z,{span:4,style:{textAlign:"right"},children:"\u6392\u4ED6\u6700\u5927\u503C\uFF1A"}),(0,e.jsx)(u.Z,{span:8,children:(0,e.jsx)(B.Z.Item,{noStyle:!0,name:"exclusiveMaximum",children:(0,e.jsx)(Q.Z,{style:{width:"100%"},placeholder:"\u8BF7\u8F93\u5165\u6392\u4ED6\u6700\u5927\u503C"})})})]})]}),ae&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(k.Z,{justify:"start",align:"middle",style:{marginBottom:13},children:[(0,e.jsx)(u.Z,{span:4,style:{textAlign:"right"},children:"\u6B63\u5219\u5339\u914D\uFF1A"}),(0,e.jsx)(u.Z,{span:20,children:(0,e.jsx)(B.Z.Item,{noStyle:!0,name:"pattern",children:(0,e.jsx)(he.Z,{placeholder:"\u8BF7\u8F93\u5165\u6B63\u5219\u5339\u914D\u516C\u5F0F"})})})]}),(0,e.jsxs)(k.Z,{justify:"start",align:"middle",style:{marginBottom:13},children:[(0,e.jsx)(u.Z,{span:4,style:{textAlign:"right"},children:"\u683C\u5F0F\uFF1A"}),(0,e.jsx)(u.Z,{span:8,children:(0,e.jsx)(B.Z.Item,{noStyle:!0,name:"format",children:(0,e.jsx)(Me.Z,{allowClear:!0,options:ot,placeholder:"\u8BF7\u9009\u62E9\u5B57\u7B26\u4E32\u683C\u5F0F",style:{width:"100%"}})})})]})]}),h&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(k.Z,{justify:"start",align:"middle",style:{marginBottom:13},children:[(0,e.jsx)(u.Z,{span:4,style:{textAlign:"right"},children:"\u5143\u7D20\u552F\u4E00\uFF1A"}),(0,e.jsx)(u.Z,{span:20,children:(0,e.jsx)(B.Z.Item,{noStyle:!0,name:"uniqueItems",valuePropName:"checked",children:(0,e.jsx)(we.Z,{})})})]}),(0,e.jsxs)(k.Z,{justify:"start",align:"middle",style:{marginBottom:13},children:[(0,e.jsx)(u.Z,{span:4,style:{textAlign:"right"},children:"\u6700\u5C11\u5143\u7D20\u4E2A\u6570\uFF1A"}),(0,e.jsx)(u.Z,{span:8,children:(0,e.jsx)(B.Z.Item,{noStyle:!0,name:"minItems",children:(0,e.jsx)(Q.Z,{style:{width:"100%"},parser:function(d){return d?parseInt(d.replace(/\D/g,""),10):""},formatter:function(d){return d?"".concat(Math.floor(Math.max(d,0))):""},placeholder:"\u8BF7\u8F93\u5165\u6700\u5C11\u5143\u7D20\u4E2A\u6570"})})}),(0,e.jsx)(u.Z,{span:4,style:{textAlign:"right"},children:"\u6700\u591A\u5143\u7D20\u4E2A\u6570\uFF1A"}),(0,e.jsx)(u.Z,{span:8,children:(0,e.jsx)(B.Z.Item,{noStyle:!0,name:"maxItems",children:(0,e.jsx)(Q.Z,{style:{width:"100%"},parser:function(d){return d?parseInt(d.replace(/\D/g,""),10):""},formatter:function(d){return d?"".concat(Math.floor(Math.max(d,0))):""},placeholder:"\u8BF7\u8F93\u5165\u6700\u591A\u5143\u7D20\u4E2A\u6570"})})})]})]}),(ae||A||V)&&(0,e.jsxs)(k.Z,{justify:"start",align:"middle",style:{marginBottom:13},children:[(0,e.jsx)(u.Z,{span:4,style:{textAlign:"right"},children:"\u679A\u4E3E\uFF1A"}),(0,e.jsx)(u.Z,{span:20,children:(0,e.jsx)(B.Z.List,{name:"enums",children:function(d,oe){var je=oe.add,Te=oe.remove;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(k.Z,{gutter:6,children:d.map(function(se){var $=se.key,Se=se.name,Ie=Ve()(se,lt);return(0,e.jsx)(u.Z,{span:12,children:(0,e.jsxs)(k.Z,{gutter:2,justify:"start",align:"middle",style:{marginBottom:6},children:[(0,e.jsx)(u.Z,{flex:"auto",children:(0,e.jsxs)(B.Z.Item,M()(M()({},Ie),{},{noStyle:!0,name:[Se],rules:[{required:!0}],children:[ae&&(0,e.jsx)(he.Z,{placeholder:"\u8BF7\u8F93\u5165\u679A\u4E3E\u503C"}),(A||V)&&(0,e.jsx)(Q.Z,{style:{width:"100%"},placeholder:"\u8BF7\u8F93\u5165\u679A\u4E3E\u503C"})]}))}),(0,e.jsx)(u.Z,{flex:"24px",children:(0,e.jsx)(le.ZP,{icon:(0,e.jsx)(Ne.Z,{}),size:"small",type:"text",danger:!0,onClick:function(){return Te(Se)}})})]})},$)})}),(0,e.jsx)(k.Z,{children:(0,e.jsx)(u.Z,{span:6,children:(0,e.jsx)(B.Z.Item,{noStyle:!0,children:(0,e.jsx)(le.ZP,{onClick:function(){return je()},block:!0,icon:(0,e.jsx)(Ce.Z,{}),children:"\u6DFB\u52A0\u679A\u4E3E\u503C"})})})})]})}})})]}),(0,e.jsx)("div",{style:{borderLeft:"3px solid ".concat(m.colorPrimary),fontSize:16,fontWeight:399,paddingLeft:8,marginBottom:13},children:"Json Schema"}),(0,e.jsx)(We,{height:300,language:"json",value:JSON.stringify(S,null,2),handleEditorDidMount:Je,onChange:function(d){ye(function(){if(d)try{var oe=JSON.parse(d);L(oe)}catch(je){}})}})]})})},dt=n(1581),ct=n.n(dt),ft=n(78045),mt=n(79443),ht=function(r){var p=r.open,C=r.onOk,I=r.onCancel,i=ie.ZP.useMessage(),P=y()(i,2),m=P[0],O=P[1],c=(0,s.useState)(),E=y()(c,2),T=E[0],J=E[1],S=(0,s.useState)(),L=y()(S,2),X=L[0],W=L[1],K=(0,s.useState)("json"),z=y()(K,2),v=z[0],re=z[1],l=(0,s.useRef)(null);function g(o){l.current=o}(0,s.useEffect)(function(){W(p)},[p]);function a(){var o;W(!1),J(void 0),(o=l.current)===null||o===void 0||o.setValue(""),I&&I()}return(0,e.jsxs)(e.Fragment,{children:[O,(0,e.jsxs)($e.Z,{title:"\u5BFC\u5165",width:900,open:X,onOk:Ke()(Oe()().mark(function o(){var h,f,Z,F,A,N;return Oe()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(!(!T||T.length===0)){x.next=3;break}return m.warning("\u8BF7\u8F93\u5165\u5BFC\u5165\u7684 Json \u6570\u636E"),x.abrupt("return");case 3:if(h=at(T),h){x.next=7;break}return m.error("\u5BFC\u5165\u7684\u5185\u5BB9\u4E0D\u662F Json \u683C\u5F0F\u7684\u6570\u636E"),x.abrupt("return");case 7:x.t0=v,x.next=x.t0==="json"?10:x.t0==="json-schema"?12:16;break;case 10:return f=new mt.NL().createSchemaOf(h),x.abrupt("break",16);case 12:return x.next=14,rt(h);case 14:return f=x.sent,x.abrupt("break",16);case 16:if(f){x.next=21;break}return m.warning("\u5BFC\u5165\u7684\u5185\u5BB9\u6709\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u540E\u91CD\u65B0\u5BFC\u5165"),x.abrupt("return");case 21:if(Z=new(ct())({allErrors:!0}),F=Z.getSchema("http://json-schema.org/draft-07/schema#"),!(F&&!F(f))){x.next=27;break}return N=(A=F.errors)===null||A===void 0?void 0:A.map(function(Y,q){var H=Y.instancePath.split("/").pop()||"root",_="".concat(H," ").concat(Y.message);return(0,e.jsx)("div",{children:'Error in field "'.concat(H,'": ').concat(_)},q)}),((N==null?void 0:N.length)||0)>0&&m.error({content:(0,e.jsx)("div",{children:N})}),x.abrupt("return");case 27:C&&C(f),a();case 29:case"end":return x.stop()}},o)})),onCancel:a,children:[(0,e.jsx)(k.Z,{style:{marginBottom:16},children:(0,e.jsx)(ft.ZP.Group,{value:v,optionType:"button",buttonStyle:"solid",onChange:function(h){return re(h.target.value)},options:[{value:"json",label:"Json"},{value:"json-schema",label:"JsonSchema"}]})}),(0,e.jsx)(k.Z,{children:(0,e.jsx)(We,{height:390,language:"json",handleEditorDidMount:g,onChange:function(h){return J(h)}})})]})]})},vt=ht,pt=n(56616),Ee=n(61865),gt=n(65695);function ke(t){var r=De.Z.useToken(),p=r.token,C=ie.ZP.useMessage(),I=y()(C,2),i=I[0],P=I[1],m=t.changeSchema,O=t.renameProperty,c=t.isArrayItems,E=t.updateRequiredProperty,T=t.parentSchemaDepth,J=T===void 0?0:T,S=t.removeProperty,L=t.addProperty,X=t.isRequire,W=t.handleAdvancedSettingClick,K=(0,s.useState)(t.schema),z=y()(K,2),v=z[0],re=z[1],l=(0,s.useState)(t.propertyName),g=y()(l,2),a=g[0],o=g[1],h=(0,s.useState)(v.title),f=y()(h,2),Z=f[0],F=f[1],A=(0,s.useState)(v.description),N=y()(A,2),ce=N[0],x=N[1],Y=(0,s.useState)(t.nodeDepth?t.nodeDepth:0),q=y()(Y,2),H=q[0],_=q[1],V=(0,s.useState)(t.namePath?t.namePath:[]),fe=y()(V,2),R=fe[0],Fe=fe[1],ae=(0,s.useState)(!0),Ae=y()(ae,2),ee=Ae[0],ye=Ae[1],Je=(0,s.useState)(!1),xe=y()(Je,2),b=xe[0],d=xe[1],oe=(0,s.useState)(!1),je=y()(oe,2),Te=je[0],se=je[1],$=typeof a=="undefined";(0,s.useEffect)(function(){re(t.schema)},[t.schema]),(0,s.useEffect)(function(){Fe(t.namePath?t.namePath:[])},[t.namePath]),(0,s.useEffect)(function(){_(t.nodeDepth?t.nodeDepth:0)},[t.nodeDepth]);var Se=(0,s.useCallback)(w().debounce(function(j){typeof j=="function"?j():console.log("Provided argument is not a function")},300,{maxWait:1e3}),[]);(0,s.useEffect)(function(){return function(){Se.cancel()}},[Se]);var Ie=v.items,be=!!(v.type==="object"||c&&(Ie==null?void 0:Ie.type)==="object")&&!c&&!$;return v.type?(0,e.jsxs)(e.Fragment,{children:[P,(0,e.jsxs)(k.Z,{align:"middle",style:{paddingBottom:10},children:[(0,e.jsx)(u.Z,{flex:"".concat(24+H*17,"px"),style:{marginLeft:H*5},children:(0,e.jsx)(k.Z,{justify:"end",children:v.type==="object"&&(0,e.jsx)(le.ZP,{type:"text",size:"small",icon:ee?(0,e.jsx)(me.Z,{}):(0,e.jsx)(pe.Z,{}),onClick:function(){return ye(!ee)}})})}),(0,e.jsx)(u.Z,{flex:"auto",style:{marginLeft:5},children:(0,e.jsx)(he.Z,{status:!$&&a.length===0?"error":void 0,disabled:$||c,value:$?"root":a,placeholder:"\u5C5E\u6027\u540D\u79F0",onBlur:function(){if((a==null?void 0:a.length)===0){i.error("\u5C5E\u6027\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A");return}O&&a&&(a==null?void 0:a.length)!==0&&O(R,a)},onChange:function(D){return o(D.target.value)}})}),(0,e.jsx)(u.Z,{flex:"16px",style:{marginLeft:5},children:(0,e.jsx)(pt.Z,{disabled:c||$,checked:X,onChange:function(D){E&&a&&E(R.slice(0,J),a,!D.target.checked)}})}),(0,e.jsx)(u.Z,{flex:"95px",style:{marginLeft:5},children:(0,e.jsx)(Me.Z,{style:{width:"95px"},value:v.type,options:st,onChange:function(D){m&&m(R,He(D),"type")}})}),(0,e.jsx)(u.Z,{flex:"auto",style:{marginLeft:5},children:(0,e.jsx)(he.Z,{placeholder:"\u6807\u9898",value:Z,onBlur:function(){m&&m(R.concat(ge(v,"title")),Z,"title")},onChange:function(D){return F(D.target.value)}})}),(0,e.jsx)(u.Z,{flex:"auto",style:{marginLeft:5},children:(0,e.jsx)(he.Z,{placeholder:"\u63CF\u8FF0",value:ce,onBlur:function(){m&&m(R.concat(ge(v,"description")),ce,"description")},onChange:function(D){return x(D.target.value)}})}),(0,e.jsx)(u.Z,{flex:"72px",style:{marginLeft:5},children:(0,e.jsxs)(k.Z,{style:{width:"72px"},children:[(0,e.jsx)(Ee.Z,{title:"\u9AD8\u7EA7\u8BBE\u7F6E",children:(0,e.jsx)(le.ZP,{type:"text",size:"small",icon:(0,e.jsx)(G.Z,{}),style:{color:"green"},onClick:function(){W&&!W(R,v,$||v.type==="object"?void 0:a)||d(!b)}})}),!$&&!c||v.type==="object"?(0,e.jsx)(gt.Z,{disabled:!be,placement:"bottom",menu:{items:[{key:"addNode",label:"\u540C\u7EA7\u8282\u70B9",onClick:function(){L&&L(R,!1)}},{key:"addChildNode",label:"\u5B50\u7EA7\u8282\u70B9",onClick:function(){L&&L(R,!0)}}]},children:(0,e.jsx)(Ee.Z,{title:!be&&"\u6DFB\u52A0\u8282\u70B9",children:(0,e.jsx)(le.ZP,{type:"text",size:"small",icon:(0,e.jsx)(Ce.Z,{}),style:{color:p.colorPrimary},onClick:function(){be||L&&L(R,!(!c&&!$))}})})}):(0,e.jsx)("div",{style:{width:"24px"}}),(0,e.jsx)(u.Z,{flex:"24px",children:$?(0,e.jsx)(Ee.Z,{title:"\u5BFC\u5165Json",children:(0,e.jsx)(le.ZP,{type:"text",size:"small",icon:(0,e.jsx)(ne.Z,{}),style:{color:"purple"},onClick:function(){return se(!0)}})}):c?(0,e.jsx)("div",{style:{width:"24px"}}):(0,e.jsx)(Ee.Z,{title:"\u5220\u9664\u8282\u70B9",children:(0,e.jsx)(le.ZP,{danger:!0,type:"text",size:"small",icon:(0,e.jsx)(Ne.Z,{}),onClick:function(){S&&S(R)}})})}),$&&v.type!=="object"&&(0,e.jsx)(u.Z,{flex:"24px",children:!c&&(0,e.jsx)("div",{style:{width:"24px"}})})]})})]}),v.type==="object"&&ee&&v.properties&&Object.keys(v.properties).map(function(j){if(v.properties){var D;return(0,e.jsx)("div",{children:(0,e.jsx)(ke,M()(M()({},t),{},{isRequire:(D=v.required)===null||D===void 0?void 0:D.includes(j),isArrayItems:!1,nodeDepth:H+1,parentSchemaDepth:$?0:J+2,namePath:R.concat(ge(v,"properties"),ge(v.properties,j)),propertyName:j,schema:v.properties[j],handleAdvancedSettingClick:W}))},String(j))}return(0,e.jsx)(e.Fragment,{})}),v.type==="array"&&ee&&(0,e.jsx)(ke,M()(M()({},t),{},{isRequire:!1,isArrayItems:!0,nodeDepth:H+1,parentSchemaDepth:$?0:J+1,propertyName:"items",namePath:R.concat(ge(v,"items")),schema:v.items,handleAdvancedSettingClick:W})),(0,e.jsx)(ut,{schema:v,open:b,onOk:function(D){if(m){if($||v.type==="object"){m(R,M()({},D)),d(!1);return}m(R,M()({},D),a),d(!1)}},onCancel:function(){return d(!1)}}),(0,e.jsx)(vt,{open:Te,onOk:function(D){m&&(m([],D),se(!1))},onCancel:function(){return se(!1)}})]}):(0,e.jsx)(e.Fragment,{})}var yt=ke,xt=(0,s.forwardRef)(function(t,r){var p=ie.ZP.useMessage(),C=y()(p,2),I=C[0],i=C[1];function P(l){var g={type:"object",properties:{field:{type:"string"}}};if(!l)return g;switch(U()(l)){case"string":try{return it(JSON.parse(l))}catch(a){return I.warning("\u521D\u59CB\u5316\u6570\u636E\u4E0D\u662F Json \u5B57\u7B26\u4E32\uFF0C\u65E0\u6CD5\u751F\u6210 JsonSchema"),g}case"object":return l}}var m=(0,s.useState)(P(t.data)),O=y()(m,2),c=O[0],E=O[1],T=(0,s.useState)(0),J=y()(T,2),S=J[0],L=J[1];(0,s.useEffect)(function(){t.onSchemaChange&&t.onSchemaChange(c)},[c]);var X=function(g,a,o){if(g.length===0){E(a);return}for(var h=w().cloneDeep(c),f=h,Z=0;Z<g.length-1;Z++){var F=Object.keys(f)[g[Z]];f[F]||(f[F]={}),f=f[F]}var A=g[g.length-1],N=Object.keys(f)[A];if(A===-1){if(typeof a=="undefined"||!o)return;f[o]=a}else{if(f[N]===a)return;f[N]=a}E(h)};function W(l,g){for(var a=w().cloneDeep(c),o=a,h=null,f="",Z=0;Z<l.length-1;Z++){var F=Object.keys(o),A=void 0;if(typeof l[Z]=="number"?A=l[Z]:A=F.indexOf(String(l[Z])),A<0||A>=F.length){console.error("Path not found: ".concat(l.slice(0,Z+1).join(".")));return}h=o,f=F[A],o=o[f]}var N=l[l.length-1],ce=Object.keys(o),x=ce[N];if(x!==g){if(o.hasOwnProperty(x))h[f]=Object.fromEntries(Object.entries(o).map(function(Y){var q=y()(Y,2),H=q[0],_=q[1];if(H===x){var V=h.required;if(V){var fe=V.indexOf(x);fe>=0&&V.splice(fe,1,g)}return[g,_]}return[H,_]}));else{console.error("Key not found: ".concat(x));return}E(a)}}function K(l,g,a){l.required||(l.required=[]);var o=l.required.indexOf(g);a?o!==-1&&l.required.splice(o,1):o===-1&&l.required.push(g),l.required.length===0&&delete l.required}function z(l,g,a){for(var o=w().cloneDeep(c),h=o,f=0;f<l.length;f++){var Z=l[f],F=Object.keys(h);typeof h[F[Z]]=="undefined"&&(h[F[Z]]={}),h=h[F[Z]]}K(h,g,a),E(o)}function v(l){for(var g=w().cloneDeep(c),a=g,o=g,h=0;h<l.length-1;h++)if(a!=null)o=a,a=a[Object.keys(a)[l[h]]];else{console.error("\u79FB\u9664\u7684\u8DEF\u5F84\u65E0\u6548",l);return}var f=Object.keys(a)[l[l.length-1]];K(o,f,!0),a&&U()(a)==="object"&&a.hasOwnProperty(f)&&delete a[f],E(g)}function re(l,g){for(var a=w().cloneDeep(c),o=a,h=0;h<l.length-(g?0:1);h++){var f=Object.keys(o)[l[h]];o[f]||(o[f]={}),o=o[f]}var Z=He("string");g?o.properties["field_".concat(S)]=Z:o["field_".concat(S)]=Z,L(S+1),E(a)}return(0,s.useImperativeHandle)(r,function(){return{changeSchema:X}}),(0,e.jsxs)("div",{style:{paddingTop:"10px 10px 0 10px"},children:[i,(0,e.jsx)(yt,{schema:c,changeSchema:X,renameProperty:W,removeProperty:v,addProperty:re,updateRequiredProperty:z,handleAdvancedSettingClick:t.handleAdvancedSettingClick})]})}),jt=xt},71860:function(Le,te,n){"use strict";n.r(te),n.d(te,{texts:function(){return U}});var Ze=n(57396);const U=[{value:"1.x.x \u7248\u672C\u7684\u4EE3\u7801\u5DF2\u5B8C\u5168\u91CD\u6784\u3002",paraId:0,tocIndex:0},{value:"\u9700\u8981\u4E0E ",paraId:0,tocIndex:0},{value:"json-schema-editor-visual",paraId:0,tocIndex:0},{value:` UI \u5E03\u5C40\u7C7B\u4F3C\u7684\u7EC4\u4EF6\uFF0C\u53EF\u4EE5\u4F7F\u7528
`,paraId:0,tocIndex:0},{value:"0.x.x",paraId:0,tocIndex:0},{value:" \u7248\u672C\u3002",paraId:0,tocIndex:0},{value:`yarn add @quiet-front-end/json-schema-editor-antd
`,paraId:1,tocIndex:0},{value:"\u7EC4\u4EF6\u4E2D\u7684 JSON \u7F16\u8F91\u5668\u7528\u7684\u662F\u52A0\u8F7D cdn \u7684\u65B9\u5F0F\uFF0C\u79BB\u7EBF\u4F7F\u7528\u9700\u6DFB\u52A0 ",paraId:2,tocIndex:1},{value:"monaco-editor",paraId:2,tocIndex:1},{value:`yarn add monaco-editor
`,paraId:3,tocIndex:1},{value:"\u52A0\u8F7D monaco-editor",paraId:4,tocIndex:1},{value:`import { loader } from '@monaco-editor/react';
import * as monaco from 'monaco-editor';

loader.config({ monaco });
`,paraId:5,tocIndex:1},{value:"JsonSchema \u53D8\u66F4\u7684\u56DE\u8C03\u3002",paraId:6,tocIndex:3},{value:"\u7C7B\u578B\uFF1A",paraId:7,tocIndex:3},{value:"(schema: JSONSchema7) => void",paraId:7,tocIndex:3},{value:"\u9ED8\u8BA4\u503C\uFF1A ",paraId:8,tocIndex:3},{value:"-",paraId:8,tocIndex:3},{value:"\u521D\u59CB\u5316\u7EC4\u4EF6\u6570\u636E\u3002",paraId:9,tocIndex:4},{value:"\u7C7B\u578B\uFF1A",paraId:10,tocIndex:4},{value:"JSONSchema7 | string | undefined",paraId:10,tocIndex:4},{value:"\u9ED8\u8BA4\u503C\uFF1A",paraId:11,tocIndex:4},{value:`{
  "type": "object",
  "properties": {
    "field": {
      "type": "string"
    }
  }
}
`,paraId:12,tocIndex:4},{value:"\u70B9\u51FB",paraId:13,tocIndex:5},{value:"\u9AD8\u7EA7\u8BBE\u7F6E",paraId:13,tocIndex:5},{value:"\u6309\u94AE\u7684\u56DE\u8C03\uFF0C\u8FD4\u56DE",paraId:13,tocIndex:5},{value:"false",paraId:13,tocIndex:5},{value:"\uFF1A\u4E0D\u4F7F\u7528\u9ED8\u8BA4\u8868\u5355\uFF0C\u8FD4\u56DE",paraId:13,tocIndex:5},{value:"true",paraId:13,tocIndex:5},{value:"\uFF1A\u4F7F\u7528\u9ED8\u8BA4\u8868\u5355\u3002",paraId:13,tocIndex:5},{value:"\u7C7B\u578B\uFF1A",paraId:14,tocIndex:5},{value:"(namePath: number[], schema: JSONSchema7, propertyName?: string) => boolean",paraId:14,tocIndex:5},{value:"\u9ED8\u8BA4\u503C\uFF1A",paraId:15,tocIndex:5},{value:"-",paraId:15,tocIndex:5},{value:"\u8BF4\u660E\uFF1A\u53EF\u4EE5\u7ED3\u5408",paraId:16,tocIndex:5},{value:"\u7EC4\u4EF6\u5F15\u7528",paraId:16,tocIndex:5},{value:"\u5B9E\u73B0\u70B9\u51FB\u9AD8\u7EA7\u8BBE\u7F6E\u6309\u94AE\u540E\u83B7\u53D6\u8DEF\u5F84\u4E0B\u7684 JsonSchema\uFF0C\u6DFB\u52A0\u3001\u4FEE\u6539\u81EA\u5B9A\u4E49\u5B57\u6BB5\u7B49\uFF0C\u7136\u540E\u4FEE\u6539\u6307\u5B9A\u8DEF\u5F84\u4E0B\u7684 JsonSchema\u3002",paraId:16,tocIndex:5},{value:`export interface JsonSchemaEditorHandle {
  /* \u66F4\u65B0\u6307\u5B9A\u8DEF\u5F84\u4E0B\u7684 JsonSchema */
  changeSchema: (namePath: number[], value: any, propertyName?: string) => void;
}
`,paraId:17,tocIndex:6}]},49832:function(){}}]);
