(self.webpackChunk_quiet_front_end_json_schema_editor_antd=self.webpackChunk_quiet_front_end_json_schema_editor_antd||[]).push([[593],{77102:function(Je,_,n){"use strict";n.r(_),n.d(_,{demos:function(){return s}});var Ze=n(15009),z=n.n(Ze),Ae=n(99289),y=n.n(Ae),ae=n(67294),Te=n(57396),V=n(9170),s={"jsonschemaeditor-demo-0":{component:ae.memo(ae.lazy(y()(z()().mark(function ye(){var k,de;return z()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,Promise.resolve().then(n.bind(n,9170));case 2:return k=w.sent,de=k.JsonSchemaEditor,w.abrupt("return",{default:function(){return ae.createElement(de,null)}});case 5:case"end":return w.stop()}},ye)})))),asset:{type:"BLOCK",id:"jsonschemaeditor-demo-0",refAtomIds:["JsonSchemaEditor"],dependencies:{"index.jsx":{type:"FILE",value:`import { JsonSchemaEditor } from '@quiet-front-end/json-schema-editor-antd';

export default () => <JsonSchemaEditor />;`},"@quiet-front-end/json-schema-editor-antd":{type:"NPM",value:"1.0.7"}},entry:"index.jsx"},context:{"@quiet-front-end/json-schema-editor-antd":V},renderOpts:{compile:function(){var ye=y()(z()().mark(function de(){var xe,w=arguments;return z()().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return ee.next=2,n.e(335).then(n.bind(n,37335));case 2:return ee.abrupt("return",(xe=ee.sent).default.apply(xe,w));case 3:case"end":return ee.stop()}},de)}));function k(){return ye.apply(this,arguments)}return k}()}}}},9170:function(Je,_,n){"use strict";n.r(_),n.d(_,{JsonSchemaEditor:function(){return xt}});var Ze=n(52677),z=n.n(Ze),Ae=n(5574),y=n.n(Ae),ae=n(68872),Te=n(96486),V=n.n(Te),s=n(67294),ye=n(97857),k=n.n(ye),de=n(39398),xe=n(14313),w=n(42952),Ce=n(24969),ee=n(57546),Le=n(48689),ze=n(13769),He=n.n(ze),be=n(9361),J=n(23323),Ne=n(75027),T=n(71230),l=n(15746),ce=n(56846),G=n(24435),Pe=n(21628),Ue=n(41637),oe=n(92797),Ve=n(63764),we={base:"vs",inherit:!0,rules:[{background:"FFFFFF",token:""},{foreground:"008e00",token:"comment"},{foreground:"7d4726",token:"meta.preprocessor"},{foreground:"7d4726",token:"keyword.control.import"},{foreground:"df0002",token:"string"},{foreground:"3a00dc",token:"constant.numeric"},{foreground:"c800a4",token:"constant.language"},{foreground:"275a5e",token:"constant.character"},{foreground:"275a5e",token:"constant.other"},{foreground:"c800a4",token:"variable.language"},{foreground:"c800a4",token:"variable.other"},{foreground:"c800a4",token:"keyword"},{foreground:"c900a4",token:"storage"},{foreground:"438288",token:"entity.name.class"},{foreground:"790ead",token:"entity.name.tag"},{foreground:"450084",token:"entity.other.attribute-name"},{foreground:"450084",token:"support.function"},{foreground:"450084",token:"support.constant"},{foreground:"790ead",token:"support.type"},{foreground:"790ead",token:"support.class"},{foreground:"790ead",token:"support.other.variable"}],colors:{"editor.foreground":"#000000","editor.background":"#FFFFFF","editor.selectionBackground":"#B5D5FF","editor.lineHighlightBackground":"#00000012","editorCursor.foreground":"#000000","editorWhitespace.foreground":"#BFBFBF"}},e=n(85893),Ge=function(r){var u=r.width,I=r.lineNumbers,S=I===void 0?"on":I,i=r.height,M=r.value,v=r.folding,E=v===void 0?!0:v,d=r.language,F=r.readOnly,L=F===void 0?!1:F,b=r.renderLineHighlight,Z=b===void 0?"all":b,N=r.onChange,Q=be.Z.useToken(),W=Q.token;function c(H){H.editor.defineTheme("x-code-default",we)}return(0,e.jsx)("div",{style:{border:"1px solid ".concat(W.colorBorder),width:u||"100%"},children:(0,e.jsx)(Ve.ZP,{height:i,width:u,value:M,language:d,onChange:N,onMount:r.handleEditorDidMount,beforeMount:c,theme:"x-code-default",options:{readOnly:L,lineNumbers:S,renderLineHighlight:Z,folding:E,smoothScrolling:!0,fontSize:13,scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:9,horizontalScrollbarSize:9},minimap:{enabled:!1}}})})},Re=Ge,Qe=n(15009),Oe=n.n(Qe),Xe=n(99289),$e=n.n(Xe),Ye=n(64599),qe=n.n(Ye),_e=n(65009),et=n.n(_e);function se(t,r){if(t.$ref){var u=t.$ref;if(u.startsWith("#/")){var I=u.slice(2).split("/"),S=V().cloneDeep(r),i=qe()(I),M;try{for(i.s();!(M=i.n()).done;){var v=M.value;if(S[v])S=S[v];else throw new Error("Unable to resolve $ref: ".concat(u))}}catch(d){i.e(d)}finally{i.f()}return S}else throw new Error("Unsupported $ref format: ".concat(u))}if(t.properties)for(var E in t.properties)t.properties[E]&&(t.properties[E]=se(t.properties[E],r));return t.items&&(Array.isArray(t.items)?t.items=t.items.map(function(d){return se(d,r)}):t.items=se(t.items,r)),t.oneOf&&(t.oneOf=t.oneOf.map(function(d){return se(d,r)})),t.anyOf&&(t.anyOf=t.anyOf.map(function(d){return se(d,r)})),t.allOf&&(t.allOf=t.allOf.map(function(d){return se(d,r)})),t}function ie(t){var r;if(t.$ref){var u=t.$ref;if(u.startsWith("#/")){var I=u.slice(2).split("/");return I[0]}if(t.properties){for(var S in t.properties)if(t.properties[S]&&(r=ie(t.properties[S]),r))return r}}if(t.items){if(Array.isArray(t.items))for(var i=0;i<t.items.length;i++){var M=t.items[i];if(r=ie(M),r)return r}else if(r=ie(t.items),r)return r}if(t.oneOf)for(var v=0;v<t.oneOf.length;v++){var E=t.oneOf[v];if(r=ie(E),r)return r}if(t.anyOf)for(var d=0;d<t.anyOf.length;d++){var F=t.anyOf[d];if(r=ie(F),r)return r}if(t.allOf)for(var L=0;L<t.allOf.length;L++){var b=t.allOf[L];if(r=ie(b),r)return r}}function tt(t){return De.apply(this,arguments)}function De(){return De=$e()(Oe()().mark(function t(r){var u,I;return Oe()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,et().dereference(r,{mutateInputSchema:!1,dereference:{circular:"ignore"}});case 2:if(u=i.sent,I=ie(u),!I){i.next=6;break}return i.abrupt("return",se(u,u));case 6:return i.abrupt("return",u);case 7:case"end":return i.stop()}},t)})),De.apply(this,arguments)}function nt(t){if(typeof t=="string"){var r=t.trim();if(r.startsWith("{")&&r.endsWith("}"))try{return JSON.parse(r)}catch(u){return}}}var We=["string","number","array","object","boolean","integer"];function je(t,r){if(t===null||z()(t)!=="object")return console.error("The provided value is not an object."),-1;var u=Object.keys(t);return u.indexOf(r)}function rt(t,r){if(r.length===0)return t;for(var u=t,I=0;I<r.length;I++){var S=Object.keys(u)[r[I]];if(S===void 0)return;u=u[S]}return u}var at=[{value:"date-time"},{value:"date"},{value:"time"},{value:"email"},{value:"hostname"},{value:"ipv4"},{value:"ipv6"},{value:"uri"},{value:"regex"}],ot=We.map(function(t){return{value:t}});function Ke(t){switch(t){case"string":return{type:"string"};case"number":return{type:"number"};case"boolean":return{type:"boolean"};case"object":return{type:"object",properties:{}};case"integer":return{type:"integer"};case"array":return{type:"array",items:{type:"string"}};case"null":}return{type:"string"}}var st=function(r){var u=function(i){return Array.isArray(i)?"array":i===null?"null":z()(i)},I=function S(i){var M=u(i);switch(M){case"object":{var v={};for(var E in i)i.hasOwnProperty(E)&&(v[E]=S(i[E]));return{type:"object",properties:v,required:Object.keys(i)}}case"array":return{type:"array",items:i.length?S(i[0]):{}};default:return{type:M}}};return I(r)},it=["key","name"],lt=function(t){var r=t.schema,u=t.open,I=u===void 0?!1:u,S=t.onOk,i=t.onCancel,M=be.Z.useToken(),v=M.token,E=J.Z.useForm(),d=y()(E,1),F=d[0],L=(0,s.useState)(),b=y()(L,2),Z=b[0],N=b[1],Q=(0,s.useState)(!1),W=y()(Q,2),c=W[0],H=W[1],te=(0,s.useState)(!1),Y=y()(te,2),a=Y[0],x=Y[1],m=(0,s.useState)(!1),o=y()(m,2),p=o[0],f=o[1],O=(0,s.useState)(!1),P=y()(O,2),A=P[0],R=P[1],fe=(0,s.useState)(!1),g=y()(fe,2),K=g[0],ne=g[1],q=(0,s.useState)(!1),X=y()(q,2),C=X[0],me=X[1],Be=(0,s.useState)(!1),Se=y()(Be,2),U=Se[0],ke=Se[1],he=(0,s.useRef)(null);(0,s.useEffect)(function(){N(r)},[r]),(0,s.useEffect)(function(){H(I)},[I]);var ve=(0,s.useCallback)(V().debounce(function(B){typeof B=="function"?B():console.log("Provided argument is not a function")},300,{maxWait:1e3}),[]);(0,s.useEffect)(function(){return function(){ve.cancel()}},[ve]),(0,s.useEffect)(function(){!c||!Z||(F.setFieldsValue(Z),x(Z.type==="object"),f(Z.type==="array"),R(Z.type==="number"),ne(Z.type==="boolean"),me(Z.type==="integer"),ke(Z.type==="string"))},[c,Z]);function Fe(B){he.current=B,he.current.setValue(JSON.stringify(r,null,2))}function le(){i&&i(),H(!1)}return(0,e.jsx)(Ne.Z,{title:"\u9AD8\u7EA7\u8BBE\u7F6E2",width:900,open:c,onOk:function(){F.validateFields().then(function(h){return S&&S(k()(k()({},Z),h))}).catch(function(h){console.log("Failed:",h)}).finally(function(){return le()})},onCancel:le,children:(0,e.jsxs)(J.Z,{form:F,onValuesChange:function(h,re){he.current&&he.current.setValue(JSON.stringify(k()(k()({},Z),re),null,2))},children:[!a&&We.indexOf(Z==null?void 0:Z.type)!==-1&&(0,e.jsx)("div",{style:{borderLeft:"3px solid ".concat(v.colorPrimary),fontSize:16,fontWeight:399,paddingLeft:8,marginBottom:13},children:"\u57FA\u672C\u8BBE\u7F6E"}),(U||A||C||K)&&(0,e.jsxs)(T.Z,{justify:"start",align:"middle",style:{marginBottom:13},children:[(0,e.jsx)(l.Z,{span:4,style:{textAlign:"right"},children:"\u9ED8\u8BA4\u503C\uFF1A"}),(0,e.jsx)(l.Z,{span:8,children:(0,e.jsxs)(J.Z.Item,{noStyle:!0,name:"default",children:[U&&(0,e.jsx)(ce.Z,{style:{width:"100%"},placeholder:"\u8BF7\u8F93\u5165\u9ED8\u8BA4\u503C"}),(A||C)&&(0,e.jsx)(G.Z,{style:{width:"100%"},placeholder:"\u8BF7\u8F93\u5165\u9ED8\u8BA4\u503C"}),K&&(0,e.jsx)(Pe.Z,{style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u9ED8\u8BA4\u503C",options:[{value:!0,label:"true"},{value:!1,label:"false"}]})]})})]}),U&&(0,e.jsxs)(T.Z,{justify:"start",align:"middle",style:{marginBottom:13},children:[(0,e.jsx)(l.Z,{span:4,style:{textAlign:"right"},children:"\u6700\u5C0F\u957F\u5EA6\uFF1A"}),(0,e.jsx)(l.Z,{span:8,children:(0,e.jsx)(J.Z.Item,{noStyle:!0,name:"minLength",children:(0,e.jsx)(G.Z,{min:0,style:{width:"100%"},parser:function(h){return h?parseInt(h.replace(/\D/g,""),10):""},formatter:function(h){return h?"".concat(Math.floor(Math.max(h,0))):""},placeholder:"\u8BF7\u8F93\u5165\u6700\u5C0F\u957F\u5EA6"})})}),(0,e.jsx)(l.Z,{span:4,style:{textAlign:"right"},children:"\u6700\u5927\u957F\u5EA6\uFF1A"}),(0,e.jsx)(l.Z,{span:8,children:(0,e.jsx)(J.Z.Item,{noStyle:!0,name:"maxLength",children:(0,e.jsx)(G.Z,{min:0,style:{width:"100%"},parser:function(h){return h?parseInt(h.replace(/\D/g,""),10):""},formatter:function(h){return h?"".concat(Math.floor(Math.max(h,0))):""},placeholder:"\u8BF7\u8F93\u5165\u6700\u5927\u957F\u5EA6"})})})]}),(A||C)&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(T.Z,{justify:"start",align:"middle",style:{marginBottom:13},children:[(0,e.jsx)(l.Z,{span:4,style:{textAlign:"right"},children:"\u6700\u5C0F\u503C\uFF1A"}),(0,e.jsx)(l.Z,{span:8,children:(0,e.jsx)(J.Z.Item,{noStyle:!0,name:"minimum",children:(0,e.jsx)(G.Z,{style:{width:"100%"},placeholder:"\u8BF7\u8F93\u5165\u6700\u5C0F\u503C"})})}),(0,e.jsx)(l.Z,{span:4,style:{textAlign:"right"},children:"\u6700\u5927\u503C\uFF1A"}),(0,e.jsx)(l.Z,{span:8,children:(0,e.jsx)(J.Z.Item,{noStyle:!0,name:"maximum",children:(0,e.jsx)(G.Z,{style:{width:"100%"},placeholder:"\u8BF7\u8F93\u5165\u6700\u5927\u503C"})})})]}),(0,e.jsxs)(T.Z,{justify:"start",align:"middle",style:{marginBottom:13},children:[(0,e.jsx)(l.Z,{span:4,style:{textAlign:"right"},children:"\u6392\u4ED6\u6700\u5C0F\u503C\uFF1A"}),(0,e.jsx)(l.Z,{span:8,children:(0,e.jsx)(J.Z.Item,{noStyle:!0,name:"exclusiveMinimum",children:(0,e.jsx)(G.Z,{style:{width:"100%"},placeholder:"\u8BF7\u8F93\u5165\u6392\u4ED6\u6700\u5C0F\u503C"})})}),(0,e.jsx)(l.Z,{span:4,style:{textAlign:"right"},children:"\u6392\u4ED6\u6700\u5927\u503C\uFF1A"}),(0,e.jsx)(l.Z,{span:8,children:(0,e.jsx)(J.Z.Item,{noStyle:!0,name:"exclusiveMaximum",children:(0,e.jsx)(G.Z,{style:{width:"100%"},placeholder:"\u8BF7\u8F93\u5165\u6392\u4ED6\u6700\u5927\u503C"})})})]})]}),U&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(T.Z,{justify:"start",align:"middle",style:{marginBottom:13},children:[(0,e.jsx)(l.Z,{span:4,style:{textAlign:"right"},children:"\u6B63\u5219\u5339\u914D\uFF1A"}),(0,e.jsx)(l.Z,{span:20,children:(0,e.jsx)(J.Z.Item,{noStyle:!0,name:"pattern",children:(0,e.jsx)(ce.Z,{placeholder:"\u8BF7\u8F93\u5165\u6B63\u5219\u5339\u914D\u516C\u5F0F"})})})]}),(0,e.jsxs)(T.Z,{justify:"start",align:"middle",style:{marginBottom:13},children:[(0,e.jsx)(l.Z,{span:4,style:{textAlign:"right"},children:"\u683C\u5F0F\uFF1A"}),(0,e.jsx)(l.Z,{span:8,children:(0,e.jsx)(J.Z.Item,{noStyle:!0,name:"format",children:(0,e.jsx)(Pe.Z,{allowClear:!0,options:at,placeholder:"\u8BF7\u9009\u62E9\u5B57\u7B26\u4E32\u683C\u5F0F",style:{width:"100%"}})})})]})]}),p&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(T.Z,{justify:"start",align:"middle",style:{marginBottom:13},children:[(0,e.jsx)(l.Z,{span:4,style:{textAlign:"right"},children:"\u5143\u7D20\u552F\u4E00\uFF1A"}),(0,e.jsx)(l.Z,{span:20,children:(0,e.jsx)(J.Z.Item,{noStyle:!0,name:"uniqueItems",valuePropName:"checked",children:(0,e.jsx)(Ue.Z,{})})})]}),(0,e.jsxs)(T.Z,{justify:"start",align:"middle",style:{marginBottom:13},children:[(0,e.jsx)(l.Z,{span:4,style:{textAlign:"right"},children:"\u6700\u5C11\u5143\u7D20\u4E2A\u6570\uFF1A"}),(0,e.jsx)(l.Z,{span:8,children:(0,e.jsx)(J.Z.Item,{noStyle:!0,name:"minItems",children:(0,e.jsx)(G.Z,{style:{width:"100%"},parser:function(h){return h?parseInt(h.replace(/\D/g,""),10):""},formatter:function(h){return h?"".concat(Math.floor(Math.max(h,0))):""},placeholder:"\u8BF7\u8F93\u5165\u6700\u5C11\u5143\u7D20\u4E2A\u6570"})})}),(0,e.jsx)(l.Z,{span:4,style:{textAlign:"right"},children:"\u6700\u591A\u5143\u7D20\u4E2A\u6570\uFF1A"}),(0,e.jsx)(l.Z,{span:8,children:(0,e.jsx)(J.Z.Item,{noStyle:!0,name:"maxItems",children:(0,e.jsx)(G.Z,{style:{width:"100%"},parser:function(h){return h?parseInt(h.replace(/\D/g,""),10):""},formatter:function(h){return h?"".concat(Math.floor(Math.max(h,0))):""},placeholder:"\u8BF7\u8F93\u5165\u6700\u591A\u5143\u7D20\u4E2A\u6570"})})})]})]}),(U||A||C)&&(0,e.jsxs)(T.Z,{justify:"start",align:"middle",style:{marginBottom:13},children:[(0,e.jsx)(l.Z,{span:4,style:{textAlign:"right"},children:"\u679A\u4E3E\uFF1A"}),(0,e.jsx)(l.Z,{span:20,children:(0,e.jsx)(J.Z.List,{name:"enums",children:function(h,re){var pe=re.add,$=re.remove;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(T.Z,{gutter:6,children:h.map(function(ue){var Ie=ue.key,ge=ue.name,j=He()(ue,it);return(0,e.jsx)(l.Z,{span:12,children:(0,e.jsxs)(T.Z,{gutter:2,justify:"start",align:"middle",style:{marginBottom:6},children:[(0,e.jsx)(l.Z,{flex:"auto",children:(0,e.jsxs)(J.Z.Item,k()(k()({},j),{},{noStyle:!0,name:[ge],rules:[{required:!0}],children:[U&&(0,e.jsx)(ce.Z,{placeholder:"\u8BF7\u8F93\u5165\u679A\u4E3E\u503C"}),(A||C)&&(0,e.jsx)(G.Z,{style:{width:"100%"},placeholder:"\u8BF7\u8F93\u5165\u679A\u4E3E\u503C"})]}))}),(0,e.jsx)(l.Z,{flex:"24px",children:(0,e.jsx)(oe.ZP,{icon:(0,e.jsx)(Le.Z,{}),size:"small",type:"text",danger:!0,onClick:function(){return $(ge)}})})]})},Ie)})}),(0,e.jsx)(T.Z,{children:(0,e.jsx)(l.Z,{span:6,children:(0,e.jsx)(J.Z.Item,{noStyle:!0,children:(0,e.jsx)(oe.ZP,{onClick:function(){return pe()},block:!0,icon:(0,e.jsx)(Ce.Z,{}),children:"\u6DFB\u52A0\u679A\u4E3E\u503C"})})})})]})}})})]}),(0,e.jsx)("div",{style:{borderLeft:"3px solid ".concat(v.colorPrimary),fontSize:16,fontWeight:399,paddingLeft:8,marginBottom:13},children:"Json Schema"}),(0,e.jsx)(Re,{height:300,language:"json",value:JSON.stringify(Z,null,2),handleEditorDidMount:Fe,onChange:function(h){ve(function(){if(h)try{var re=JSON.parse(h);N(re)}catch(pe){}})}})]})})},ut=n(1581),dt=n.n(ut),ct=n(78045),ft=n(79443),mt=function(r){var u=r.open,I=r.onOk,S=r.onCancel,i=ae.ZP.useMessage(),M=y()(i,2),v=M[0],E=M[1],d=(0,s.useState)(),F=y()(d,2),L=F[0],b=F[1],Z=(0,s.useState)(),N=y()(Z,2),Q=N[0],W=N[1],c=(0,s.useState)("json"),H=y()(c,2),te=H[0],Y=H[1],a=(0,s.useRef)(null);function x(o){a.current=o}(0,s.useEffect)(function(){W(u)},[u]);function m(){var o;W(!1),b(void 0),(o=a.current)===null||o===void 0||o.setValue(""),S&&S()}return(0,e.jsxs)(e.Fragment,{children:[E,(0,e.jsxs)(Ne.Z,{title:"\u5BFC\u5165",width:900,open:Q,onOk:$e()(Oe()().mark(function o(){var p,f,O,P,A,R;return Oe()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!(!L||L.length===0)){g.next=3;break}return v.warning("\u8BF7\u8F93\u5165\u5BFC\u5165\u7684 Json \u6570\u636E"),g.abrupt("return");case 3:if(p=nt(L),p){g.next=7;break}return v.error("\u5BFC\u5165\u7684\u5185\u5BB9\u4E0D\u662F Json \u683C\u5F0F\u7684\u6570\u636E"),g.abrupt("return");case 7:g.t0=te,g.next=g.t0==="json"?10:g.t0==="json-schema"?12:16;break;case 10:return f=new ft.NL().createSchemaOf(p),g.abrupt("break",16);case 12:return g.next=14,tt(p);case 14:return f=g.sent,g.abrupt("break",16);case 16:if(f){g.next=21;break}return v.warning("\u5BFC\u5165\u7684\u5185\u5BB9\u6709\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u540E\u91CD\u65B0\u5BFC\u5165"),g.abrupt("return");case 21:if(O=new(dt())({allErrors:!0}),P=O.getSchema("http://json-schema.org/draft-07/schema#"),!(P&&!P(f))){g.next=27;break}return R=(A=P.errors)===null||A===void 0?void 0:A.map(function(K,ne){var q=K.instancePath.split("/").pop()||"root",X="".concat(q," ").concat(K.message);return(0,e.jsx)("div",{children:'Error in field "'.concat(q,'": ').concat(X)},ne)}),((R==null?void 0:R.length)||0)>0&&v.error({content:(0,e.jsx)("div",{children:R})}),g.abrupt("return");case 27:I&&I(f),m();case 29:case"end":return g.stop()}},o)})),onCancel:m,children:[(0,e.jsx)(T.Z,{style:{marginBottom:16},children:(0,e.jsx)(ct.ZP.Group,{value:te,optionType:"button",buttonStyle:"solid",onChange:function(p){return Y(p.target.value)},options:[{value:"json",label:"Json"},{value:"json-schema",label:"JsonSchema"}]})}),(0,e.jsx)(T.Z,{children:(0,e.jsx)(Re,{height:390,language:"json",handleEditorDidMount:x,onChange:function(p){return b(p)}})})]})]})},ht=mt,vt=n(56616),Ee=n(61865),pt=n(65695);function Me(t){var r=be.Z.useToken(),u=r.token,I=ae.ZP.useMessage(),S=y()(I,2),i=S[0],M=S[1],v=t.changeSchema,E=t.renameProperty,d=t.isArrayItems,F=t.updateRequiredProperty,L=t.removeProperty,b=t.addProperty,Z=t.isRequire,N=t.handleAdvancedSettingClick,Q=(0,s.useState)(t.schema),W=y()(Q,2),c=W[0],H=W[1],te=(0,s.useState)(t.propertyName),Y=y()(te,2),a=Y[0],x=Y[1],m=(0,s.useState)(c.title),o=y()(m,2),p=o[0],f=o[1],O=(0,s.useState)(c.description),P=y()(O,2),A=P[0],R=P[1],fe=(0,s.useState)(t.nodeDepth?t.nodeDepth:0),g=y()(fe,2),K=g[0],ne=g[1],q=(0,s.useState)(t.namePath?t.namePath:[]),X=y()(q,2),C=X[0],me=X[1],Be=(0,s.useState)(!0),Se=y()(Be,2),U=Se[0],ke=Se[1],he=(0,s.useState)(!1),ve=y()(he,2),Fe=ve[0],le=ve[1],B=(0,s.useState)(!1),h=y()(B,2),re=h[0],pe=h[1],$=typeof a=="undefined";(0,s.useEffect)(function(){H(t.schema)},[t.schema]),(0,s.useEffect)(function(){me(t.namePath?t.namePath:[])},[t.namePath]),(0,s.useEffect)(function(){ne(t.nodeDepth?t.nodeDepth:0)},[t.nodeDepth]);var ue=(0,s.useCallback)(V().debounce(function(j){typeof j=="function"?j():console.log("Provided argument is not a function")},300,{maxWait:1e3}),[]);(0,s.useEffect)(function(){return function(){ue.cancel()}},[ue]);var Ie=c.items,ge=!!(c.type==="object"||d&&(Ie==null?void 0:Ie.type)==="object")&&!d&&!$;return c.type?(0,e.jsxs)(e.Fragment,{children:[M,(0,e.jsxs)(T.Z,{align:"middle",style:{paddingBottom:10},children:[(0,e.jsx)(l.Z,{flex:"".concat(24+K*17,"px"),style:{marginLeft:K*5},children:(0,e.jsx)(T.Z,{justify:"end",children:c.type==="object"&&(0,e.jsx)(oe.ZP,{type:"text",size:"small",icon:U?(0,e.jsx)(de.Z,{}):(0,e.jsx)(xe.Z,{}),onClick:function(){return ke(!U)}})})}),(0,e.jsx)(l.Z,{flex:"auto",style:{marginLeft:5},children:(0,e.jsx)(ce.Z,{status:!$&&a.length===0?"error":void 0,disabled:$||d,value:$?"root":a,placeholder:"\u5C5E\u6027\u540D\u79F0",onBlur:function(){if((a==null?void 0:a.length)===0){i.error("\u5C5E\u6027\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A");return}E&&a&&(a==null?void 0:a.length)!==0&&E(C,a)},onChange:function(D){return x(D.target.value)}})}),(0,e.jsx)(l.Z,{flex:"16px",style:{marginLeft:5},children:(0,e.jsx)(vt.Z,{disabled:d||$,checked:Z,onChange:function(D){F&&a&&F(C,!D.target.checked)}})}),(0,e.jsx)(l.Z,{flex:"95px",style:{marginLeft:5},children:(0,e.jsx)(Pe.Z,{style:{width:"95px"},value:c.type,options:ot,onChange:function(D){v&&v(C,Ke(D),"type")}})}),(0,e.jsx)(l.Z,{flex:"auto",style:{marginLeft:5},children:(0,e.jsx)(ce.Z,{placeholder:"\u6807\u9898",value:p,onBlur:function(){v&&v(C.concat(je(c,"title")),p,"title")},onChange:function(D){return f(D.target.value)}})}),(0,e.jsx)(l.Z,{flex:"auto",style:{marginLeft:5},children:(0,e.jsx)(ce.Z,{placeholder:"\u63CF\u8FF0",value:A,onBlur:function(){v&&v(C.concat(je(c,"description")),A,"description")},onChange:function(D){return R(D.target.value)}})}),(0,e.jsx)(l.Z,{flex:"72px",style:{marginLeft:5},children:(0,e.jsxs)(T.Z,{style:{width:"72px"},children:[(0,e.jsx)(Ee.Z,{title:"\u9AD8\u7EA7\u8BBE\u7F6E",children:(0,e.jsx)(oe.ZP,{type:"text",size:"small",icon:(0,e.jsx)(w.Z,{}),style:{color:"green"},onClick:function(){N&&!N(C,c,$||c.type==="object"?void 0:a)||le(!Fe)}})}),!$&&!d||c.type==="object"?(0,e.jsx)(pt.Z,{disabled:!ge,placement:"bottom",menu:{items:[{key:"addNode",label:"\u540C\u7EA7\u8282\u70B9",onClick:function(){b&&b(C,!1)}},{key:"addChildNode",label:"\u5B50\u7EA7\u8282\u70B9",onClick:function(){b&&b(C,!0)}}]},children:(0,e.jsx)(Ee.Z,{title:!ge&&"\u6DFB\u52A0\u8282\u70B9",children:(0,e.jsx)(oe.ZP,{type:"text",size:"small",icon:(0,e.jsx)(Ce.Z,{}),style:{color:u.colorPrimary},onClick:function(){ge||b&&b(C,!(!d&&!$))}})})}):(0,e.jsx)("div",{style:{width:"24px"}}),(0,e.jsx)(l.Z,{flex:"24px",children:$?(0,e.jsx)(Ee.Z,{title:"\u5BFC\u5165Json",children:(0,e.jsx)(oe.ZP,{type:"text",size:"small",icon:(0,e.jsx)(ee.Z,{}),style:{color:"purple"},onClick:function(){return pe(!0)}})}):d?(0,e.jsx)("div",{style:{width:"24px"}}):(0,e.jsx)(Ee.Z,{title:"\u5220\u9664\u8282\u70B9",children:(0,e.jsx)(oe.ZP,{danger:!0,type:"text",size:"small",icon:(0,e.jsx)(Le.Z,{}),onClick:function(){L&&L(C)}})})}),$&&c.type!=="object"&&(0,e.jsx)(l.Z,{flex:"24px",children:!d&&(0,e.jsx)("div",{style:{width:"24px"}})})]})})]}),c.type==="object"&&U&&c.properties&&Object.keys(c.properties).map(function(j){if(c.properties){var D;return(0,e.jsx)("div",{children:(0,e.jsx)(Me,k()(k()({},t),{},{isRequire:(D=c.required)===null||D===void 0?void 0:D.includes(j),isArrayItems:!1,nodeDepth:K+1,namePath:C.concat(je(c,"properties"),je(c.properties,j)),propertyName:j,schema:c.properties[j],handleAdvancedSettingClick:N}))},String(j))}return(0,e.jsx)(e.Fragment,{})}),c.type==="array"&&U&&(0,e.jsx)(Me,k()(k()({},t),{},{isRequire:!1,isArrayItems:!0,nodeDepth:K+1,propertyName:"items",namePath:C.concat(je(c,"items")),schema:c.items,handleAdvancedSettingClick:N})),(0,e.jsx)(lt,{schema:c,open:Fe,onOk:function(D){if(v){if($||c.type==="object"){v(C,k()({},D)),le(!1);return}v(C,k()({},D),a),le(!1)}},onCancel:function(){return le(!1)}}),(0,e.jsx)(ht,{open:re,onOk:function(D){v&&(v([],D),pe(!1))},onCancel:function(){return pe(!1)}})]}):(0,e.jsx)(e.Fragment,{})}var gt=Me,yt=(0,s.forwardRef)(function(t,r){var u=ae.ZP.useMessage(),I=y()(u,2),S=I[0],i=I[1];function M(a){var x={type:"object",properties:{field:{type:"string"}}};if(!a)return x;switch(z()(a)){case"string":try{return st(JSON.parse(a))}catch(m){return S.warning("\u521D\u59CB\u5316\u6570\u636E\u4E0D\u662F Json \u5B57\u7B26\u4E32\uFF0C\u65E0\u6CD5\u751F\u6210 JsonSchema"),x}case"object":return a}}var v=(0,s.useState)(M(t.data)),E=y()(v,2),d=E[0],F=E[1],L=(0,s.useState)(0),b=y()(L,2),Z=b[0],N=b[1];(0,s.useEffect)(function(){t.onSchemaChange&&t.onSchemaChange(d)},[d]);var Q=function(x,m,o){if(x.length===0){F(m);return}for(var p=V().cloneDeep(d),f=p,O=0;O<x.length-1;O++){var P=Object.keys(f)[x[O]];f[P]||(f[P]={}),f=f[P]}var A=x[x.length-1],R=Object.keys(f)[A];if(A===-1){if(typeof m=="undefined"||!o)return;f[o]=m}else{if(f[R]===m)return;f[R]=m}F(p)};function W(a,x){for(var m=V().cloneDeep(d),o=m,p=null,f="",O=0;O<a.length-1;O++){var P=Object.keys(o),A=void 0;if(typeof a[O]=="number"?A=a[O]:A=P.indexOf(String(a[O])),A<0||A>=P.length){console.error("Path not found: ".concat(a.slice(0,O+1).join(".")));return}p=o,f=P[A],o=o[f]}var R=a[a.length-1],fe=Object.keys(o),g=fe[R];if(g!==x){if(o.hasOwnProperty(g))p[f]=Object.fromEntries(Object.entries(o).map(function(K){var ne=y()(K,2),q=ne[0],X=ne[1];if(q===g){var C=p.required;if(C){var me=C.indexOf(g);me>=0&&C.splice(me,1,x)}return[x,X]}return[q,X]}));else{console.error("Key not found: ".concat(g));return}F(m)}}function c(a,x,m){a.required||(a.required=[]);var o=a.required.indexOf(x);m?o!==-1&&a.required.splice(o,1):o===-1&&a.required.push(x),a.required.length===0&&delete a.required}function H(a,x){if(a.length<2){console.error("\u8DEF\u5F84\u957F\u5EA6\u4E0D\u8DB3\uFF0C\u65E0\u6CD5\u66F4\u65B0\u5FC5\u9009\u5C5E\u6027");return}var m=V().cloneDeep(d),o=a.slice(0,-2),p=a[a.length-1],f=rt(m,o);if(!f||!f.properties){console.error("\u65E0\u6CD5\u627E\u5230\u5FC5\u9009\u5C5E\u6027\u7684\u7236\u5BF9\u8C61",f);return}var O=Object.keys(f.properties);if(p<0||p>=O.length){console.error("\u5C5E\u6027\u7D22\u5F15\u8D85\u51FA\u8303\u56F4",p);return}var P=O[p];c(f,P,x),F(m)}function te(a){for(var x=V().cloneDeep(d),m=x,o=x,p=0;p<a.length-1;p++)if(m!=null)o=m,m=m[Object.keys(m)[a[p]]];else{console.error("\u79FB\u9664\u7684\u8DEF\u5F84\u65E0\u6548",a);return}var f=Object.keys(m)[a[a.length-1]];c(o,f,!0),m&&z()(m)==="object"&&m.hasOwnProperty(f)&&delete m[f],F(x)}function Y(a,x){for(var m=V().cloneDeep(d),o=m,p=0;p<a.length-(x?0:1);p++){var f=Object.keys(o)[a[p]];o[f]||(o[f]={}),o=o[f]}var O=Ke("string");x?o.properties["field_".concat(Z)]=O:o["field_".concat(Z)]=O,N(Z+1),F(m)}return(0,s.useImperativeHandle)(r,function(){return{changeSchema:Q}}),(0,e.jsxs)("div",{style:{paddingTop:"10px 10px 0 10px"},children:[i,(0,e.jsx)(gt,{schema:d,changeSchema:Q,renameProperty:W,removeProperty:te,addProperty:Y,updateRequiredProperty:H,handleAdvancedSettingClick:t.handleAdvancedSettingClick})]})}),xt=yt},71860:function(Je,_,n){"use strict";n.r(_),n.d(_,{texts:function(){return z}});var Ze=n(57396);const z=[{value:"1.x.x \u7248\u672C\u7684\u4EE3\u7801\u5DF2\u5B8C\u5168\u91CD\u6784\u3002",paraId:0,tocIndex:0},{value:"\u9700\u8981\u4E0E ",paraId:0,tocIndex:0},{value:"json-schema-editor-visual",paraId:0,tocIndex:0},{value:` UI \u5E03\u5C40\u7C7B\u4F3C\u7684\u7EC4\u4EF6\uFF0C\u53EF\u4EE5\u4F7F\u7528
`,paraId:0,tocIndex:0},{value:"0.x.x",paraId:0,tocIndex:0},{value:" \u7248\u672C\u3002",paraId:0,tocIndex:0},{value:`yarn add @quiet-front-end/json-schema-editor-antd
`,paraId:1,tocIndex:0},{value:"\u7EC4\u4EF6\u4E2D\u7684 JSON \u7F16\u8F91\u5668\u7528\u7684\u662F\u52A0\u8F7D cdn \u7684\u65B9\u5F0F\uFF0C\u79BB\u7EBF\u4F7F\u7528\u9700\u6DFB\u52A0 ",paraId:2,tocIndex:1},{value:"monaco-editor",paraId:2,tocIndex:1},{value:`yarn add monaco-editor
`,paraId:3,tocIndex:1},{value:"\u52A0\u8F7D monaco-editor",paraId:4,tocIndex:1},{value:`import { loader } from '@monaco-editor/react';
import * as monaco from 'monaco-editor';

loader.config({ monaco });
`,paraId:5,tocIndex:1},{value:"JsonSchema \u53D8\u66F4\u7684\u56DE\u8C03\u3002",paraId:6,tocIndex:3},{value:"\u7C7B\u578B\uFF1A",paraId:7,tocIndex:3},{value:"(schema: JSONSchema7) => void",paraId:7,tocIndex:3},{value:"\u9ED8\u8BA4\u503C\uFF1A ",paraId:8,tocIndex:3},{value:"-",paraId:8,tocIndex:3},{value:"\u521D\u59CB\u5316\u7EC4\u4EF6\u6570\u636E\u3002",paraId:9,tocIndex:4},{value:"\u7C7B\u578B\uFF1A",paraId:10,tocIndex:4},{value:"JSONSchema7 | string | undefined",paraId:10,tocIndex:4},{value:"\u9ED8\u8BA4\u503C\uFF1A",paraId:11,tocIndex:4},{value:`{
  "type": "object",
  "properties": {
    "field": {
      "type": "string"
    }
  }
}
`,paraId:12,tocIndex:4},{value:"\u70B9\u51FB",paraId:13,tocIndex:5},{value:"\u9AD8\u7EA7\u8BBE\u7F6E",paraId:13,tocIndex:5},{value:"\u6309\u94AE\u7684\u56DE\u8C03\uFF0C\u8FD4\u56DE",paraId:13,tocIndex:5},{value:"false",paraId:13,tocIndex:5},{value:"\uFF1A\u4E0D\u4F7F\u7528\u9ED8\u8BA4\u8868\u5355\uFF0C\u8FD4\u56DE",paraId:13,tocIndex:5},{value:"true",paraId:13,tocIndex:5},{value:"\uFF1A\u4F7F\u7528\u9ED8\u8BA4\u8868\u5355\u3002",paraId:13,tocIndex:5},{value:"\u7C7B\u578B\uFF1A",paraId:14,tocIndex:5},{value:"(namePath: number[], schema: JSONSchema7, propertyName?: string) => boolean",paraId:14,tocIndex:5},{value:"\u9ED8\u8BA4\u503C\uFF1A",paraId:15,tocIndex:5},{value:"-",paraId:15,tocIndex:5},{value:"\u8BF4\u660E\uFF1A\u53EF\u4EE5\u7ED3\u5408",paraId:16,tocIndex:5},{value:"\u7EC4\u4EF6\u5F15\u7528",paraId:16,tocIndex:5},{value:"\u5B9E\u73B0\u70B9\u51FB\u9AD8\u7EA7\u8BBE\u7F6E\u6309\u94AE\u540E\u83B7\u53D6\u8DEF\u5F84\u4E0B\u7684 JsonSchema\uFF0C\u6DFB\u52A0\u3001\u4FEE\u6539\u81EA\u5B9A\u4E49\u5B57\u6BB5\u7B49\uFF0C\u7136\u540E\u4FEE\u6539\u6307\u5B9A\u8DEF\u5F84\u4E0B\u7684 JsonSchema\u3002",paraId:16,tocIndex:5},{value:`export interface JsonSchemaEditorHandle {
  /* \u66F4\u65B0\u6307\u5B9A\u8DEF\u5F84\u4E0B\u7684 JsonSchema */
  changeSchema: (namePath: number[], value: any, propertyName?: string) => void;
}
`,paraId:17,tocIndex:6}]},49832:function(){}}]);
